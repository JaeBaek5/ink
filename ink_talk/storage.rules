rules_version = '2';
// Firebase Storage 보안 규칙 (INK 채팅방 미디어 업로드용)
// 업로드 경로: rooms/{roomId}/media/{timestamp}_{fileName}
// 복구: 해당 채팅방 멤버만 읽기·쓰기 허용 (Firestore rooms 문서의 memberIds로 검증)

service firebase.storage {
  match /b/{bucket}/o {
    match /rooms/{roomId}/media/{fileName} {
      allow read, write: if request.auth != null
        && request.auth.uid in firestore.get(/databases/(default)/documents/rooms/$(roomId)).data.memberIds;
    }
  }
}
