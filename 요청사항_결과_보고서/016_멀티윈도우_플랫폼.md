# [016] Phase 15 멀티 윈도우 / 플랫폼 확장

## 요청 정보

- **날짜:** 2026-01-29
- **요청 내용:** 개발 순서 Phase 15 진행
  - 분할/팝업 멀티 윈도우 지원
  - iOS 빌드 테스트
  - Web 빌드 테스트
  - (선택) PC 앱 빌드

---

## 진행 내용

### 1. 분할/팝업 멀티 윈도우 지원

- **Android**
  - `AndroidManifest.xml`의 `MainActivity`에 `android:resizeableActivity="true"` 추가.
  - 분할 화면(Split Screen) 시 창 크기 변경이 앱에 전달되며, `MediaQuery`가 갱신되어 기존 반응형 레이아웃(`Responsive`, `AdaptiveScaffold`)이 그대로 적용됨.

- **iOS**
  - Flutter 기본 템플릿은 단일 윈도우(Scene 미사용). iPad에서 분할 화면 시 **창 크기만 변경**되며, 단일 윈도우가 리사이즈되는 형태로 동작.
  - Firebase(cloud_firestore) 요구사항에 맞춰 **Podfile**에서 `platform :ios, '15.0'`으로 최소 배포 타깃 상향.
  - Info.plist에 분할 화면 대응 관련 주석 추가.

- **공통**
  - `lib/core/utils/window_utils.dart` 추가: `isCompactWindow(context)`, `windowSize(context)` 등 창 크기·좁은 창 여부 판별 유틸 제공. 분할로 창이 좁아졌을 때 컴팩트 레이아웃 분기 등에 활용 가능.

- **참고**
  - **여러 개의 독립 창(팝업/멀티 윈도우)**을 띄우는 기능은 Flutter 기본 템플릿만으로는 미지원. iOS는 SceneDelegate, Android는 multi-window API 등 플랫폼별 구현이 필요하며, 추후 확장 시 적용 가능.

### 2. iOS 빌드 테스트

- **변경 사항**
  - `ios/Podfile`: `platform :ios, '15.0'` 설정 (기본 13.0 → 15.0, Firebase 호환).

- **빌드**
  - `flutter build ios --no-codesign` 실행 시, 환경에 따라 다음이 필요할 수 있음:
    - CocoaPods 스펙이 오래된 경우: `cd ios && pod repo update && pod install` 후 재빌드.
    - `Firebase/Firestore (= 12.8.0)` 스펙을 찾지 못하는 경우에도 `pod repo update`로 해결 가능.
  - 실제 기기/시뮬레이터 배포 전에는 Xcode에서 서명 설정 후 빌드·실행하는 것을 권장.

### 3. Web 빌드 테스트

- **결과:** 성공.
- **명령:** `flutter build web`
- **비고:** 아이콘 트리쉐이킹, Wasm dry run 안내 등 일반적인 웹 빌드 메시지만 출력되었으며, `build/web` 산출물 생성 완료.

### 4. (선택) PC 앱 빌드

- **macOS**
  - `flutter build macos`는 기본 비활성 상태. 사용 시 `flutter config --enable-macos-desktop` 실행 후 빌드 가능.
- **Windows**
  - Windows 호스트에서 `flutter config --enable-windows-desktop` 후 `flutter build windows`로 빌드 가능.

---

## 결과

- [x] 분할/팝업 멀티 윈도우 지원: Android `resizeableActivity`, iOS 15.0, `WindowUtils` 추가
- [ ] iOS 빌드 테스트: Podfile 수정 완료, 로컬에서 `pod repo update` 및 빌드 실행 권장
- [x] Web 빌드 테스트: 성공
- [ ] (선택) PC 앱 빌드: 데스크톱 플랫폼 활성화 후 빌드 가능하도록 안내

---

## 변경된 파일

| 구분 | 경로 |
|------|------|
| 수정 | `ink_talk/android/app/src/main/AndroidManifest.xml` (resizeableActivity) |
| 수정 | `ink_talk/ios/Runner/Info.plist` (분할 화면 주석) |
| 수정 | `ink_talk/ios/Podfile` (platform :ios, '15.0') |
| 신규 | `ink_talk/lib/core/utils/window_utils.dart` |

---

## 테스트 방법

1. **분할 화면 (Android):** 7.0+ 기기에서 앱 실행 후 최근 앱 키 → 앱 아이콘 길게 눌러 "분할 화면" 선택. 다른 앱과 나란히 두고 INK 앱이 반으로 줄어든 상태에서 레이아웃이 재구성되는지 확인.
2. **분할 화면 (iOS):** iPad에서 앱 실행 후 상단에서 스와이프해 Dock을 띄우고 다른 앱을 끌어와 분할. INK 창 크기가 줄어들며 레이아웃이 바뀌는지 확인.
3. **Web:** `flutter build web` 후 `build/web`을 로컬 서버로 서빙하거나 Firebase Hosting 등에 배포해 동작 확인.
4. **iOS 빌드:** `cd ink_talk && (cd ios && pod repo update && pod install) && flutter build ios --no-codesign`

---

## 참고 문서

- `잉크_앱프로젝트_정보/개발_순서.md` Phase 15
- [Flutter iOS deployment target](https://docs.flutter.dev/deployment/ios)
- [Flutter desktop support](https://docs.flutter.dev/platform-integration/desktop)
